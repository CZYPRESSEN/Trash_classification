# YOLOv8 目标检测训练流程

一个完整的 YOLOv8 目标检测模型训练流程，包含数据集准备、验证、数据增强和优化的训练配置。

## 主要功能

- 自动化数据集完整性检查
- 智能训练/验证/测试集划分
- 自定义数据增强流程
- 优化的 YOLOv8 训练配置
- 支持11种目标类别
- 全面的错误处理机制

## 环境要求

### 软件依赖

```bash
pip install ultralytics
pip install opencv-python
pip install scikit-learn
pip install albumentations
pip install pyyaml
```

## 数据集结构

要求的数据集结构：
```
数据集目录/
    ├── 图片1.jpg
    ├── 图片1.json
    ├── 图片2.jpg
    ├── 图片2.json
    └── ...
```

### JSON标签格式
```json
{
    "labels": [
        {
            "name": "类别名称",
            "x1": float,
            "y1": float,
            "x2": float,
            "y2": float
        }
    ]
}
```

## 支持的类别

1. 土豆 (0)
2. 白萝卜 (1)
3. 胡萝卜 (2)
4. 瓶子 (3)
5. 罐头 (4)
6. 电池 (5)
7. 药品 (6)
8. 内包装 (7)
9. 瓷砖 (8)
10. 石头 (9)
11. 砖块 (10)

## 使用方法

1. 按要求准备数据集
2. 配置数据集路径：
```python
datapath = './你的数据集路径'  # 根据实际情况修改
```
3. 运行训练脚本：
```bash
python train_yolov8_easydata.py
```

## 处理流程

### 1. 数据集验证
- 检查图片文件完整性
- 验证 JSON 标签格式
- 确保图片-标签对的一致性
- 过滤损坏或无效数据

### 2. 数据集准备
- 按 80/10/10 比例划分训练/验证/测试集
- 将 JSON 标注转换为 YOLO 格式
- 创建规范的目录结构
- 生成 data.yaml 配置文件

### 3. 数据增强
实现了精心调优的数据增强流程：
- 亮度和对比度调整
- 色调和饱和度变化
- CLAHE 增强
- 水平翻转
- 几何变换
- 噪声和模糊效果

### 4. 训练配置
优化的训练参数：
- AdamW 优化器及预热策略
- 自定义学习率调度
- 平衡的损失权重
- 禁用复杂增强
- 早停机制
- 定期模型保存

## 目录结构

运行后将创建以下结构：
```
./
├── train/
│   ├── images/
│   └── labels/
├── val/
│   ├── images/
│   └── labels/
├── test/
│   ├── images/
│   └── labels/
├── data.yaml
└── runs/
    └── train/
```

## 训练参数

关键配置参数：
- 训练轮数：100
- 图片尺寸：640x640
- 批次大小：16
- 初始学习率：0.0005
- 优化器：AdamW
- 早停耐心值：50
- 检查点保存间隔：5轮

## 性能考虑

- 支持 GPU 加速
- 多工作进程数据加载
- 内存高效的数据处理
- 健壮的错误处理
- 训练进度监控和日志记录

## 错误处理

流程包含全面的错误处理机制：
- 数据集完整性问题
- 文件读写操作
- 训练过程监控
- 资源管理
- 无效数据格式

## 代码贡献

欢迎提交问题和改进建议！
